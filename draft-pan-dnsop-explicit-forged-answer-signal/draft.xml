<?xml version="1.0" encoding="utf-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.4 (Ruby 3.0.6) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC1034 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.1034.xml">
<!ENTITY RFC1035 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.1035.xml">
<!ENTITY RFC8499 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8499.xml">
<!ENTITY RFC8914 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8914.xml">
<!ENTITY RFC8484 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8484.xml">
]>


<rfc ipr="trust200902" docName="draft-pan-dnsop-explicit-forged-answer-signal-01" category="bcp" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true">
  <front>
    <title abbrev="EFAS">Explicit Forged Answer Signal</title>

    <author initials="L." surname="Pan" fullname="Lanlan Pan">
      <organization></organization>
      <address>
        <postal>
          <city>Guangdong</city>
          <country>China</country>
        </postal>
        <email>abbypan@gmail.com</email>
      </address>
    </author>

    <date year="2024" month="August" day="20"/>

    <area>ops</area>
    <workgroup>dnsop</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<?line 112?>

<t>This document describes about the forged answer provided by recursive resolver.</t>

<t>Client could protect user on security and privacy more efficiently if recursive resolver gives explict signal in the forged answer.</t>



    </abstract>



  </front>

  <middle>


<?line 118?>

<section anchor="background"><name>Background</name>

<t>Recursive resolver may make a forged answer for a dns query in some specific scenarios, 
such as NXDOMAIN, phishing, fraud, malware, ransomware, botnet DDoS attack, and legal requirement, etc.
See also <xref target="NXRedierct"/> <xref target="ISPRedirect"/> <xref target="DNSFirewall"/> <xref target="LegalRedirect"/>.</t>

<t>The RCODE of faked answer is NOERROR, which make client hard to distinguish it with honest answer, if client doesn't make iterative dns query by itself, or make DNSSEC validation.</t>

<t>Faked answer can avoid user to visit malicious website, however, it may also increase the security and privacy risk.</t>

<section anchor="http-cookies-leakage"><name>HTTP Cookies Leakage</name>

<t>The HTTP cookies risk has been well discussed in <xref target="NXDamageControl"/> and <xref target="NXDNSLies"/>. Furthermore, the risk is not only occured on NXDOMAIN scenario, but also on other faked answer scenarios.</t>

<t>Imagine that user visits "abc.example.com" in browser.</t>

<t>Recursive resolver return a faked answer to browser.</t>

<t>Browser will visit the faked server, and leak the HTTP cookies in "example.com" of the user to it.</t>

<t>With the leaked HTTP cookies, the faked server may pretend as the user to visit "abc.example.com", result in user's security issue and privacy leakage.</t>

</section>
</section>
<section anchor="terminology"><name>Terminology</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <xref target="RFC2119"/>.</t>

<t>Basic terms used in this specification are defined in the documents <xref target="RFC1034"/>, <xref target="RFC1035"/>, <xref target="RFC8499"/>.</t>

<t><list style="symbols">
  <t>Authoritative Server: Described in <xref target="RFC8499"/>.</t>
  <t>Recursive Resolver: Described in <xref target="RFC8499"/>.</t>
</list></t>

</section>
<section anchor="explicit-forged-answer-signal"><name>Explicit Forged Answer Signal</name>

<t>To avoid the HTTP cookies leakage, the recursive resolver is responsible for giving explict forged answer signal to client, and client could make its own reaction when it received an explict forged answer signal from recursive resolver.</t>

<section anchor="recursive-resolver"><name>Recursive Resolver</name>

<t>Recursive resolver could give the explict forged answer signal by including an additional Extended DNS Errors (EDE) information in DNS response, which is defined in <xref target="RFC8914"/>.</t>

<t>Alternatively, recursive resolver could include an TXT RR in DNS answer section, such as:</t>

<figure><artwork><![CDATA[
abc.example.com  300 IN  A  1.2.3.4
abc.example.com  300 IN  TXT  "faked=malware" 
]]></artwork></figure>

</section>
<section anchor="client"><name>Client</name>

<t>Client could implement its own policy to deal with the forged answer:</t>

<t><list style="symbols">
  <t>Use DNSSEC: Client could make DNSSEC query by itself. If the domain has deployed DNSSEC, the client could validate the honest answer from authoritative server.</t>
  <t>Change Recursive Resolver: Client could change to another recursive resolver which is not lying.</t>
  <t>Stop Visit: Client could stop to visit on the website, since it knows that the answer is faked.</t>
  <t>Limited Visit: Client could make limited visit on the website, prevent HTTP cookies from being send to the faked server. For example, browser should not send user's HTTP cookies to the faked server, if it gets an explict faked answer signal in the DoH response <xref target="RFC8484"/>.</t>
</list></t>

</section>
</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>Faked answer is unauthenticated by authoritative server, just offered by recursive resolver on some specific scenarios.
With the DNSSEC deployed on second level domain, client would not trust any faked answer if it makes all RRSIG validation by itself.
Ideally, recursive resolver should be honest to client, give the explicit faked answer signal in DNS response.
Explict faked answer signal could help browser to mitigate the http cookies leaked to faked server, protect user security and privacy in conditional limited environment.</t>

</section>
<section anchor="acknowledgements"><name>Acknowledgements</name>

<t>Thanks to all in the DNSOP mailing list.</t>

</section>


  </middle>

  <back>


    <references title='Normative References' anchor="sec-normative-references">

&RFC2119;
&RFC1034;
&RFC1035;
&RFC8499;
&RFC8914;
&RFC8484;


    </references>

    <references title='Informative References' anchor="sec-informative-references">

<reference anchor="NXRedierct" target="https://kb.isc.org/docs/aa-01150">
  <front>
    <title>NXDOMAIN Redirection Using DLZ in BIND 9.10 and later</title>
    <author >
      <organization>ISC</organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="ISPRedirect" target="https://datatracker.ietf.org/doc/draft-livingood-dns-redirect/">
  <front>
    <title>DNS Redirect Use by Service Providers</title>
    <author initials="J. L. R." surname="Weber" fullname="J. Livingood, R. Weber">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="DNSFirewall" target="https://www.isc.org/rpz/">
  <front>
    <title>Response Policy Zones (RPZ)</title>
    <author >
      <organization>ISC</organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="LegalRedirect" target="https://pulse.internetsociety.org/blog/oups-french-government-mistakenly-blocks-telegram-access-for-millions">
  <front>
    <title>Oups! French Government Mistakenly Blocks Telegram Access for Millions</title>
    <author initials="D." surname="York" fullname="Dan York">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="NXDamageControl" target="https://queue.acm.org/detail.cfm?id=1647302">
  <front>
    <title>What DNS Is Not</title>
    <author initials="P." surname="Vixie" fullname="Paul Vixie">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="NXDNSLies" target="https://www.potaroo.net/ispcol/2009-12/nxdomain.pdf">
  <front>
    <title>NXDOMAIN?</title>
    <author initials="G." surname="Huston" fullname="Geoff Huston">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>


    </references>


<?line 203?>



  </back>

<!-- ##markdown-source:
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
6QxXumqZpGWSBP8FMeFwBs0XAAA=

-->

</rfc>

