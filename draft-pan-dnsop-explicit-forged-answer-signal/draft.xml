<?xml version="1.0" encoding="utf-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.4 (Ruby 3.0.6) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC1034 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.1034.xml">
<!ENTITY RFC1035 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.1035.xml">
<!ENTITY RFC8499 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8499.xml">
<!ENTITY RFC8914 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8914.xml">
<!ENTITY RFC8484 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8484.xml">
]>


<rfc ipr="trust200902" docName="draft-pan-dnsop-explicit-forged-answer-signal-01" category="bcp" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true">
  <front>
    <title abbrev="EFAS">Explicit Forged Answer Signal</title>

    <author initials="L." surname="Pan" fullname="Lanlan Pan">
      <organization></organization>
      <address>
        <postal>
          <city>Guangdong</city>
          <country>China</country>
        </postal>
        <email>abbypan@gmail.com</email>
      </address>
    </author>

    <date year="2024" month="August" day="20"/>

    <area>ops</area>
    <workgroup>dnsop</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<?line 112?>

<t>This document describes about the forged answer provided by recursive resolver.</t>

<t>Client could protect user on security and privacy more efficiently if recursive resolver gives explict signal in the forged answer.</t>



    </abstract>



  </front>

  <middle>


<?line 118?>

<section anchor="background"><name>Background</name>

<t>Recursive resolver may make a forged answer for a dns query in some specific scenarios, 
such as NXDOMAIN, phishing, fraud, malware, ransomware, botnet DDoS attack, and legal requirement, etc.
See also <xref target="NXRedierct"/> <xref target="ISPRedirect"/> <xref target="DNSFirewall"/> <xref target="LegalRedirect"/>.</t>

<t>The RCODE of faked answer is NOERROR, which make client hard to distinguish it with honest answer, if client doesn't make iterative dns query by itself, or make DNSSEC validation.</t>

<t>Faked answer can avoid user to visit malicious website, however, it may also increase the security and privacy risk.</t>

<section anchor="http-cookies-leakage"><name>HTTP Cookies Leakage</name>

<t>The HTTP cookies risk has been well discussed in <xref target="NXDamageControl"/> and <xref target="NXDNSLies"/>. Furthermore, the risk is not only occured on NXDOMAIN scenario, but also on other faked answer scenarios.</t>

<t>Imagine that user visits "abc.example.com" in browser.</t>

<t>Recursive resolver return a faked answer to browser.</t>

<t>Browser will visit the faked server, and leak the HTTP cookies in "example.com" of the user to it.</t>

<t>With the leaked HTTP cookies, the faked server may pretend as the user to visit "abc.example.com", result in user's security issue and privacy leakage.</t>

</section>
</section>
<section anchor="terminology"><name>Terminology</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <xref target="RFC2119"/>.</t>

<t>Basic terms used in this specification are defined in the documents <xref target="RFC1034"/>, <xref target="RFC1035"/>, <xref target="RFC8499"/>.</t>

<t><list style="symbols">
  <t>Authoritative Server: Described in <xref target="RFC8499"/>.</t>
  <t>Recursive Resolver: Described in <xref target="RFC8499"/>.</t>
</list></t>

</section>
<section anchor="explicit-forged-answer-signal"><name>Explicit Forged Answer Signal</name>

<t>To avoid the HTTP cookies leakage, the recursive resolver is responsible for giving explict forged answer signal to client, and client could make its own reaction when it received an explict forged answer signal from recursive resolver.</t>

<section anchor="recursive-resolver"><name>Recursive Resolver</name>

<t>Recursive resolver could give the explict forged answer signal by including an additional Extended DNS Errors (EDE) information in DNS response, which is defined in <xref target="RFC8914"/>.</t>

<t>Alternatively, recursive resolver could include an TXT RR in DNS answer section, such as:</t>

<figure><artwork><![CDATA[
abc.example.com  300 IN  A  1.2.3.4
abc.example.com  300 IN  TXT  "faked=malware" 
]]></artwork></figure>

</section>
<section anchor="client"><name>Client</name>

<t>These four actions can be implemented on client to deal with the forged answer:
- Use DNSSEC: Client could make DNSSEC query by itself. If the domain has deployed DNSSEC, the client could validate the honest answer from authoritative server.
- Change Recursive Resolver: Client could change to another recursive resolver which is not lying.
- Stop Visit: Client could stop to visit on the website, since it knows that the answer is faked.
- Limited Visit: Client could make limited visit on the website, prevent HTTP cookies from being send to the faked server. For example, browser should not send user's HTTP cookies to the faked server, if it gets an explict faked answer signal in the DoH response <xref target="RFC8484"/>.</t>

</section>
</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>Faked answer is unauthenticated by authoritative server, just offered by recursive resolver on some specific scenarios.</t>

<t>With the DNSSEC deployed on second level domain, client would not trust any faked answer if it makes all RRSIG validation by itself.</t>

<t>Ideally, recursive resolver should be honest to client, give the explicit faked answer signal in DNS response.</t>

<t>Explict faked answer signal could help browser to mitigate the http cookies leaked to faked server, protect user security and privacy in conditional limited environment.</t>

</section>
<section anchor="acknowledgements"><name>Acknowledgements</name>

<t>Thanks to all in the DNSOP mailing list.</t>

</section>


  </middle>

  <back>


    <references title='Normative References' anchor="sec-normative-references">

&RFC2119;
&RFC1034;
&RFC1035;
&RFC8499;
&RFC8914;
&RFC8484;


    </references>

    <references title='Informative References' anchor="sec-informative-references">

<reference anchor="NXRedierct" target="https://kb.isc.org/docs/aa-01150">
  <front>
    <title>NXDOMAIN Redirection Using DLZ in BIND 9.10 and later</title>
    <author >
      <organization>ISC</organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="ISPRedirect" target="https://datatracker.ietf.org/doc/draft-livingood-dns-redirect/">
  <front>
    <title>DNS Redirect Use by Service Providers</title>
    <author initials="J. L. R." surname="Weber" fullname="J. Livingood, R. Weber">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="DNSFirewall" target="https://www.isc.org/rpz/">
  <front>
    <title>Response Policy Zones (RPZ)</title>
    <author >
      <organization>ISC</organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="LegalRedirect" target="https://pulse.internetsociety.org/blog/oups-french-government-mistakenly-blocks-telegram-access-for-millions">
  <front>
    <title>Oups! French Government Mistakenly Blocks Telegram Access for Millions</title>
    <author initials="D." surname="York" fullname="Dan York">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="NXDamageControl" target="https://queue.acm.org/detail.cfm?id=1647302">
  <front>
    <title>What DNS Is Not</title>
    <author initials="P." surname="Vixie" fullname="Paul Vixie">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>
<reference anchor="NXDNSLies" target="https://www.potaroo.net/ispcol/2009-12/nxdomain.pdf">
  <front>
    <title>NXDOMAIN?</title>
    <author initials="G." surname="Huston" fullname="Geoff Huston">
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>


    </references>


<?line 202?>



  </back>

<!-- ##markdown-source:
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
SnFDYml8M53iblctk7RMkuC/rFi6DtYXAAA=

-->

</rfc>

